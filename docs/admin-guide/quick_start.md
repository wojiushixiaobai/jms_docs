# 快速入门

!!! info "以下操作均在 Web 页面完成，请使用 admin 用户登陆，默认密码 admin"

## 一、系统设置


### 1.1 基本设置

!!! warning
    `当前站点URL`    不设置的话，邮件收到的地址为 http://localhost 开头  
    `Email主题前缀`  邮件的标题，比如 `[JMS]创建用户成功`

!!! success "`用户向导URL`    用户首次登陆可以看到此 `超链接`，可以忽略不设置"


### 1.2 邮件设置

!!! warning "必须设置才能使用与邮件相关的功能"
    ??? danger "不可以同时勾选 `使用SSL` 和 `使用TLS`"
        `使用SSL`  如果端口使用 `465`，必须勾选此项  
        `使用TLS`  如果端口使用 `587`，必须勾选此项
    `SMTP主机` 输入你或者你服务商提供的 smtp 服务器, 格式：`smtp.qq.com`  
    `SMTP端口` 通常是 `25`，推荐使用更安全的 `465` 或者 `587`  
    `SMTP账号` 通过是 `user@domain.com`
    `SMTP密码` 输入对应账户的密码，注意：每次测试都需要重新输入密码  
    `发送账号`  与 `SMTP账户` 保持一致

!!! tip "`测试收件人` 测试连接时一定要输入"

## 二、资产管理

!!! note "准备两个测试资产和一个数据库来验证功能"

```
+--------------+-----------------+------------+------------+---------------+---------------+
|      IP      |    Host name    |    Port    |   System   |  Admin User   |    Password   |
+==============+=================+============+============+===============+===============+
| 172.16.80.11 |    test_ssh01   |     22     |  Centos 7  |      root     |  Test@2020.L  |
+--------------+-----------------+------------+------------+---------------+---------------+
| 172.16.80.21 |    test_rdp01   |    3389    | Windows 10 | administrator |  Test@2020.W  |
+--------------+-----------------+------------+------------+---------------+---------------+
| 172.16.80.31 |   test_mysql01  |    3306    |   Mysql 5  |      root     |  Test@2020.M  |
+--------------+-----------------+------------+------------+---------------+---------------+
```

!!! warning "Windows 资产先进行 [Windows SSH 设置](https://docs.jumpserver.org)"

!!! warning "Mysql Server 需要授权 core 和 koko 的远程访问的权限"
    ```
    mysql -uroot
    ```
    ```mysql
    grant all on *.* to 'root'@'%' identified by 'Test@2020.M';  
    flush privileges;
    ```

### 2.1 编辑资产树###

!!! warning "根节点 Default 不能重名, 右击节点可以添加、删除和重命名节点, 以及进行资产相关的操作"

!!! note "说明"
    点击页面左侧的 `资产管理` - `资产列表`  
    先在根节点 `Default` 右键新建 `SSH Server` 和 `RDP Server` 两个节点

### 2.2 创建管理用户

!!! note "点击页面左侧的 `资产管理` - `新建管理用户` 创建两个管理用户, 管理用户的内容就是上面表单的 `Admin User` 和 `Password`"
    !!! warning "名称不能重名, 密码或者密钥二选一即可, 一些资产不允许通过 密码 认证可以改用 私钥 认证"
    `名称` 172.16.80.11_root  
    `用户名` root  
    `密码` Test@2020.L  
    点击 `保存`

    再创建 Windows 资产的 `管理用户`  
    `名称` 172.16.80.21_administrator  
    `用户名` administrator  
    `密码` Test@2020.W  
    点击 `保存`

### 2.3 创建资产

!!! note "点击页面左侧的 `资产管理` - `资产列表` - `创建资产` 把两个资产导入"
    !!! warning "主机名不能重名"
    `主机名` test_ssh01  
    `IP` 172.16.80.11  
    `系统平台` Linux  
    `协议组` ssh 22  
    `管理用户` 172.16.80.11_root  
    `节点` Default / SSH Server  
    点击 `保存`

    再创建 Windows 资产, 注意协议组我们需要选择 `ssh` 和 `rdp`, 否则无法获取 Windows 资产的状态及硬件信息  
    `主机名` 172.16.80.21_administrator  
    `IP` 172.16.80.21  
    `系统平台` Windows2016  
    `协议组` rdp 3389 / ssh 22  
    `管理用户` test_test_rdp01_administrator  
    `节点` Default / RDP Server  
    点击 `保存`

??? tip "测试资产连接提示"
    1. 资产创建信息填写好保存之后隔几秒钟时间刷新一下网页, `ssh` 协议资产的可连接图标会显示 `绿色`, 且 `硬件信息` 会显示出来  
    2. 如果 `可连接` 的图标是 `黄色` 或者 `红色` , 可以点击 `资产` 的 `名称`，在右侧 `快速修改` - `测试可连接性` 点击 `测试` 按钮, 根据错误提示处理  
    3. 被连接 `Linux` 资产需要 `python` 组件, 且版本大于等于 `2.6`, `Ubuntu` 等资产默认不允许 `root` 用户远程 `ssh` 登录, 请自行处理, `Windows` 资产需要手动安装 `OpenSSH Server `
    4. 如果资产不能正常连接, 请检查 管理用户 的 `用户名` 和 `密码` 是否正确以及该 `管理用户` 是否能使用 `SSH` 从 `JumpServer` 主机正确登录到资产主机上


### 2.3.1 创建数据库应用

!!! note "击页面左侧的 `应用管理` - `数据库应用` - `创建数据库应用` 创建 mysql 数据库"
    `名称` test_mysql01  
    `类型` MySQL  
    `主机` 172.16.80.31  
    `端口` 3306  

!!! tip "数据库 选项可以留空, 如果是某些特定用户, 只允许访问指定的数据库, 这里指定数据库名称即可"

### 2.4 创建系统用户

```
+--------------+------------+---------------+---------------+--------------+--------------+-------------+
|      IP      |   System   |  System User  |    Password   |     Group    |     Sudo     |  Sftp Root  |
+==============+============+===============+===============+==============+==============+=============+
| 172.16.80.11 |  Centos 7  |   testssh01   |  random pass  |              |      ALL     |      /      |
+--------------+------------+---------------+---------------+--------------+--------------+-------------+
| 172.16.80.21 | Windows 10 |   testrdp01   |  random pass  |     Users    |              |             |
+--------------+------------+---------------+---------------+--------------+--------------+-------------+
| 172.16.80.23 |   Mysql 5  |      root     |  Test@2020.M  |              |              |             |
+--------------+------------+---------------+---------------+--------------+--------------+-------------+
```

??? tip "系统用户提示"
    在理解 `系统用户` 之前, 你首先得知道系统用户是干嘛用的. 在 `Jumpserver` 中, 需要对资产不同的用途创建不同的 `系统用户`  
    比如一个 `资产`, 开发要用、测试要用、可能还要其他的部门也要使用, 偷懒的人可能会统一给 `root` 用户, 但是这样并不安全  
    系统用户就是为了解决这个问题, 我们针对不同的用途创建不同的 `系统用户`, `Linux` 通过 `Sudo` 来控制用户的权限, `Windows` 通过组来控制用户权限

!!! note "点击页面左侧的 `资产管理` - `系统用户` - `创建系统用户` 创建两个系统用户"
    `名称` test_ssh01_测试系统用户  
    `登录模式` 自动登陆  
    `用户名` testssh01  
    `协议` ssh  
    `Sudo` ALL
    `SFTP根路径` /  
    其他选项默认, 点击 `保存`

    再创建 Windows 系统用户  
    `名称` test_rdp01_测试系统用户  
    `登录模式` 自动登陆  
    `用户名` testrdp01  
    `协议` rdp  
    其他选项默认, 点击 `保存`

    创建 MySQL 系统用户  
    `名称` test_mysql01_测试系统用户  
    `登录模式` 自动登陆  
    `用户名` root  
    `协议` mysql  
    `密码` Test@2020.M  
    其他选项默认, 点击 `保存`

## 三、创建授权规则

### 3.1 为用户分配资产

```
+--------------+------------+---------------+-----------------+
|      IP      |   System   |  System User  | Jumpserver User |
+==============+============+===============+=================+
| 172.16.80.11 |  Centos 7  |   testssh01   |      admin      |
+--------------+------------+---------------+-----------------+
| 172.16.80.21 | Windows 10 |   testrdp01   |      admin      |
+--------------+------------+---------------+-----------------+
| 172.16.80.31 |  Mysql 5   |      root     |      admin      |
+--------------+------------+---------------+-----------------+
```

!!! note "点击页面左侧的 `授权管理` - `资产授权` - `创建授权规则` 创建两个授权"
    `名称` test_ssh01_测试授权  
    `用户` Administrator(admin)  
    `资产` test_ssh01(172.16.80.11)  
    `系统用户` test_ssh01_测试系统用户(testssh01)  
    `有效期` 时间自行定义, 用户只能在有效期时间内连接资产  
    修改完成后点击 `保存`

    再创建 Windows 授权  
    `名称` test_rdp01_测试授权  
    `用户` Administrator(admin)  
    `资产` test_rdp01(172.16.80.21)  
    `系统用户` test_rdp01_测试系统用户(testrdp01)  
    修改完成后点击 `保存`

??? tip "资产授权提示"
    `名称`, 授权的名称, 不能重复  
    `用户` 和 `用户组` 二选一, 不推荐即选择 `用户` 又选择 `用户组`  
    `资产` 和 `节点` 二选一, 选择 `节点` 会包含 `节点` 下面的所有 `资产`  
    `系统用户`, 及所选的 `用户` 或 `用户组` 下的 `用户` 能通过该 `系统用户` 使用所选 `节点` 或者 `节点` 下的 `资产`  
    `用户(组)`, `资产(节点)`, `系统用户` 是一对一的关系, 所以当拥有 `Linux`、`Windows` 不同类型资产时, 应该分别给 `Linux` 资产和 `Windows` 资产创建 `授权规则`  
    一般情况下, `资产`授权给`用户`, `节点`授权给`用户组`, 一个`授权`只能选择一个`系统用户`

### 3.1.1 为用户分配数据库应用

!!! note "点击页面左侧的 `授权管理` - `数据库应用` - `创建授权规则`  创建数据库授权"
    `名称` test_mysql01_测试授权  
    `用户` Administrator(admin)  
    `数据库应用` test_mysql01  
    `系统用户` test_mysql01_测试系统用户(root)  
    修改完成后点击 `保存`

## 四、用户登录

!!! tip "登录 JumpServer"
    点击页面左侧的 `会话管理` - `Web终端`
    用户只能看到自己被管理员授权了的 `资产` , 如果登录后无资产, 请联系管理员进行确认

!!! tip "连接资产"
    在我的资产点击资产右边的  `连接`  快速连接资产  
    也可以点击左侧栏的  `Web终端`
    点击  `资产`  名字, 就连上资产了  
    如果显示连接 `超时`, 请参考 `FAQ` 文档进行处理

!!! tip "断开资产"
    点击页面顶部的 `Server` 按钮会弹出选个选项, 第一个断开所选的连接, 第二个断开所有连接  
    也可以直接点资产小窗口的 X , `SSH` 会话也可以输入 `exit` 来退出  
    直接关闭页面也可以, 但是不推荐

!!! tip "文件管理"
    点击 `文件管理`  
    先在左边选择` 资产`, 目前只支持自动登录的 `SSH` 协议 `资产`  
    也可以使用 `sftp` 方式进行 `文件管理`

!!! note "以上就是 JumpServer 的简易入门了, JumpServer 还有很多功能等待您去发现"
